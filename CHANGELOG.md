# 更新日志

## 版本 1.1.0 (2025-10-31)

### ✨ 新功能
- ➕ 添加PDF页面方向选择（横向/纵向）
  - 在PDF设置区域新增方向选择单选按钮
  - 支持所有页面尺寸（A3/A4/A5/自定义）的横向和纵向
  - 默认为纵向
- ➕ **自动生成图片浏览页面**
  - 为每个目录自动生成 `index.html` 文件
  - 扫描二维码后可直接在浏览器中查看所有图片
  - 支持点击图片查看大图（Lightbox效果）
  - 响应式设计，支持手机和电脑浏览
  - 现代化UI，优秀的用户体验

### 🐛 Bug修复
- 🔧 **修复OSS上传路径问题**
  - OSS上传现在包含完整的目录结构
  - 路径格式：`base_path/根目录名/子目录名/文件`
  - 例如：`test/西沟乡麻地沟村（资料扫描）/何皂皂/image.jpg`
- 🔧 **修复二维码URL指向问题**
  - 二维码现在指向图片浏览页面（index.html）
  - URL包含完整路径和文件名
  - 扫描二维码后可以看到该目录下的所有图片列表
- 🔧 **修复无法查看图片列表的问题**
  - 之前二维码只指向OSS目录，无法浏览图片
  - 现在会生成专门的HTML页面用于图片浏览
  - 支持图片预览和大图查看

### 💡 改进
- 优化路径构建逻辑，确保上传和URL的一致性
- 改进默认URL生成，包含完整目录结构
- 更新函数签名，增加 `root_dir` 参数传递
- 新增 `generate_index_html()` 函数，生成精美的图片浏览页面
- index.html 包含完整样式和交互，无需外部依赖
- 图片使用懒加载，提高大量图片时的性能

### 📝 文档更新
- 更新 FIX_THREE_ISSUES.md，详细说明四个问题的修复
- 添加图片浏览功能的详细说明

---

## 版本 1.0.1 (2025-10-30)

### 🐛 Bug修复
- 🔧 更新GitHub Actions到最新版本
  - actions/checkout@v3 → v4
  - actions/setup-python@v4 → v5
  - actions/upload-artifact@v3 → v4
- 🔧 添加workflow权限配置（修复403 Release创建失败）
  - 添加 `permissions: contents: write`
- 🔧 简化Release文件上传
  - 只上传可执行文件 wdcl2.exe
  - 移除中文文件名上传避免404错误
  - 在Release说明中添加文档链接
- 🔧 移除不存在的icon.ico引用
- 🔧 添加更多PyInstaller隐藏导入以确保打包完整性

### 📝 文档更新
- 更新GitHub_Actions指南.md，说明Actions版本
- 更新BUGFIX_ACTIONS.md，添加权限配置说明
- 创建FIX_403_ERROR.md，详细说明权限问题
- 创建FIX_404_ERROR.md，说明文件上传问题

### 💡 改进
- Release说明中包含文档链接，用户可直接访问GitHub查看
- Artifact仍然包含所有文件供开发者下载

---

## 版本 1.0.0 (2025-10-30)

### 🎉 首次发布

#### 核心功能
- ✅ 图形化用户界面（基于Tkinter）
- ✅ 支持二级（村）和三级（乡）目录结构
- ✅ 自动扫描目录中的图片文件
- ✅ 生成包含OSS链接的二维码
- ✅ 创建包含二维码的PDF文档
- ✅ 多线程处理，不阻塞界面
- ✅ 实时日志反馈

#### 🆕 OSS上传功能
- ✅ 集成阿里云OSS SDK
- ✅ OSS配置界面（Access Key、Endpoint、Bucket等）
- ✅ 配置保存和加载功能
- ✅ OSS连接测试功能
- ✅ 自动上传图片到OSS
- ✅ 支持批量上传目录
- ✅ 上传进度实时反馈
- ✅ 自动生成OSS访问URL
- ✅ "仅上传到OSS"功能

#### PDF功能
- ✅ 支持A3、A4、A5标准尺寸
- ✅ 支持自定义页面尺寸
- ✅ 可自定义二维码大小（毫米）
- ✅ 可自定义二维码位置（坐标系统）

#### 🚀 GitHub Actions自动构建
- ✅ 配置Windows自动构建workflow
- ✅ 支持Tag触发自动构建
- ✅ 支持手动触发构建
- ✅ 自动创建GitHub Release
- ✅ PyInstaller打包配置
- ✅ 本地构建脚本（build.sh/build.bat）

#### 二维码功能
- ✅ 高质量输出（300 DPI）
- ✅ 自定义大小
- ✅ 高容错率
- ✅ PNG格式输出

#### 用户体验
- ✅ 友好的GUI界面
- ✅ 清晰的参数说明
- ✅ 处理进度显示
- ✅ 详细的日志输出
- ✅ 错误提示

#### 文档
- ✅ README.md - 项目说明
- ✅ 操作指南.md - 详细操作步骤
- ✅ 快速开始.md - 快速入门
- ✅ 项目结构.md - 技术文档

#### 辅助工具
- ✅ start.sh - macOS/Linux启动脚本
- ✅ start.bat - Windows启动脚本
- ✅ test.py - 功能测试脚本
- ✅ requirements.txt - 依赖管理

#### 支持的图片格式
- JPG/JPEG
- PNG
- GIF
- BMP
- TIFF
- WebP

#### 技术栈
- Python 3.9+
- Tkinter (GUI)
- qrcode (二维码生成)
- Pillow (图像处理)
- ReportLab (PDF生成)

### 已知限制

1. 单个PDF只包含二维码，不包含原始图片
2. OSS上传需要手动完成
3. 二维码大小和位置需要手动调整

### 测试环境

- ✅ macOS
- ⚠️  Windows (未完全测试)
- ⚠️  Linux (未完全测试)

---

## 未来版本计划

### 版本 1.1.0（计划中）

#### 功能增强
- [ ] 图片预览功能
- [ ] PDF预览功能
- [ ] 配置参数保存和加载
- [ ] 处理结果统计报告
- [ ] 支持批量自定义不同目录的参数

#### 用户体验
- [ ] 进度百分比显示
- [ ] 更友好的错误提示
- [ ] 支持拖拽选择目录
- [ ] 快捷键支持

#### 优化
- [ ] 处理速度优化
- [ ] 内存占用优化
- [ ] 更详细的日志分级

### 版本 2.0.0（计划中）

#### 重大功能
- [ ] 集成阿里云OSS SDK，支持自动上传
- [ ] 支持多种PDF模板
- [ ] 支持在PDF中插入图片缩略图
- [ ] 支持批量编辑二维码内容
- [ ] 支持水印功能

#### 高级功能
- [ ] 支持数据库记录处理历史
- [ ] 支持导出Excel报告
- [ ] 支持命令行模式
- [ ] 支持插件系统

---

## 技术债务

- [ ] 添加单元测试
- [ ] 添加集成测试
- [ ] 改进错误处理
- [ ] 代码重构（分离GUI和业务逻辑）
- [ ] 添加配置文件支持
- [ ] 添加国际化支持

---

## 贡献指南

欢迎提交问题和改进建议！

### 报告问题

如果发现bug，请提供：
1. 问题描述
2. 复现步骤
3. 预期行为
4. 实际行为
5. 系统环境（操作系统、Python版本等）
6. 日志输出

### 功能建议

欢迎提出新功能建议，请说明：
1. 功能描述
2. 使用场景
3. 预期效果

---

## 维护者

开发团队

---

## 许可证

本项目仅供内部使用。

---

**最后更新**: 2025-10-30
