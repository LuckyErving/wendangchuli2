# 文档处理工具 - 二维码、PDF与OSS管理器

## 功能介绍

这是一个基于Python和Tkinter的图形界面应用，用于批量为目录中的图片生成二维码和PDF文档，并支持自动上传到阿里云OSS。

### 主要功能：
1. **自动扫描目录结构**：支持二级（村）或三级（乡）目录结构
2. **OSS集成**：自动上传图片到阿里云OSS，生成访问链接
3. **生成二维码**：为每个最深层目录生成包含实际OSS链接的二维码图片
4. **创建PDF**：将二维码插入到自定义PDF中，支持多种页面尺寸
5. **灵活配置**：可自定义二维码大小、位置、PDF尺寸等参数
6. **Windows可执行文件**：通过GitHub Actions自动构建.exe文件

## 安装说明

### 1. 环境要求
- Python 3.7+
- macOS / Windows / Linux

### 2. 安装依赖

已创建虚拟环境，激活后安装依赖：

```bash
# 激活虚拟环境
source .venv/bin/activate  # macOS/Linux
# 或
.venv\Scripts\activate  # Windows

# 安装依赖（已自动安装）
pip install -r requirements.txt
```

## 使用说明

### 1. 启动应用

```bash
# 确保已激活虚拟环境
source .venv/bin/activate

# 运行应用
python main.py
```

### 2. 配置参数

#### 目录设置
- **根目录**：选择包含所有子目录的根目录（如：`西沟乡麻地沟村（资料扫描）`）
- **目录结构**：
  - **村（二级目录）**：根目录/一级目录（如：西沟乡麻地沟村/何皂皂）
  - **乡（三级目录）**：根目录/一级目录/二级目录

#### OSS设置
- **OSS基础URL**：阿里云OSS的访问地址（如：`https://your-bucket.oss-cn-beijing.aliyuncs.com/`）

#### PDF设置
- **页面尺寸**：可选择A3、A4、A5或自定义尺寸
  - 自定义尺寸需输入宽度和高度（单位：毫米）
  - A4尺寸为210mm × 297mm

#### 二维码设置
- **二维码大小**：以毫米为单位（默认50mm）
- **坐标位置**：
  - X坐标：距离页面左边的距离（毫米）
  - Y坐标：距离页面底边的距离（毫米）
  - 注意：坐标原点在页面左下角

### 3. 开始处理

1. 配置好所有参数后，点击"开始生成"按钮
2. 程序会自动遍历所有目标目录
3. 处理进度和结果会在日志窗口中显示
4. 完成后会弹出提示框

### 4. 输出文件

对于每个处理的目录，会生成两个文件：
- `目录名_qr.png`：二维码图片
- `目录名_qr.pdf`：包含二维码的PDF文档

## 目录结构示例

### 村（二级）结构：
```
西沟乡麻地沟村（资料扫描）/
├── 何皂皂/
│   ├── image1.jpg
│   ├── image2.jpg
│   ├── 何皂皂_qr.png     ← 生成
│   └── 何皂皂_qr.pdf     ← 生成
├── 刘彩统/
│   ├── image1.jpg
│   ├── 刘彩统_qr.png     ← 生成
│   └── 刘彩统_qr.pdf     ← 生成
└── ...
```

### 乡（三级）结构：
```
某乡/
├── 村1/
│   ├── 家庭1/
│   │   ├── image1.jpg
│   │   ├── 家庭1_qr.png  ← 生成
│   │   └── 家庭1_qr.pdf  ← 生成
│   └── 家庭2/
│       └── ...
└── 村2/
    └── ...
```

## 注意事项

1. **图片格式**：支持常见图片格式（jpg, jpeg, png, gif, bmp, tiff, webp）
2. **OSS链接**：请确保OSS基础URL正确，程序会自动拼接目录名
3. **坐标系统**：PDF使用左下角为原点的坐标系统
4. **性能**：处理大量目录时，可能需要一些时间，请耐心等待
5. **权限**：确保程序对目标目录有写入权限

## 常见问题

### Q: 二维码在PDF中的位置不对？
A: 检查坐标设置。记住坐标原点在左下角，Y轴向上为正。

### Q: 某些目录没有生成文件？
A: 检查日志，可能是该目录中没有图片文件。

### Q: 如何调整二维码在页面上的位置？
A: 修改X和Y坐标值。例如：
   - 左上角：X=10, Y=页面高度-二维码大小-10
   - 右下角：X=页面宽度-二维码大小-10, Y=10
   - 居中：X=(页面宽度-二维码大小)/2, Y=(页面高度-二维码大小)/2

### Q: 如何将文件上传到OSS？
A: 本工具不包含上传功能。建议使用：
   - 阿里云OSS控制台
   - ossutil命令行工具
   - 其他OSS管理工具

## 技术栈

- **Python**: 核心编程语言
- **Tkinter**: GUI框架
- **qrcode**: 二维码生成
- **Pillow**: 图像处理
- **ReportLab**: PDF生成

## 许可证

本项目仅供内部使用。

## 联系方式

如有问题，请联系开发团队。
